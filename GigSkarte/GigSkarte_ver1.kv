#:import dp kivy.metrics.dp
#:import MDFabButton kivymd.uix.button.MDFabButton
#:import MDCard kivymd.uix.card.MDCard
#:import MDLabel kivymd.uix.label.MDLabel

ScreenManager:
    SignUpScreen:
        name: "signup"
    LoginScreen:
        name: "login"
    SelectScreen:
        name: "select"
    InterestsScreen:
        name: "interests"
    JobScreen1:   # Worker job screen, no add button
        name: "job_screen_1"
    JobDetailsScreen:
        name: "job_details"
    JobScreen2:   # Employer job screen with add button
        name: "job_screen"
    EditableJobScreen:
        name: "editable_screen"


<SignUpScreen>:
    GridLayout:
        cols: 2
        padding: 20
        spacing: 10

        Label:
            text: "Email (optional):"
        TextInput:
            id: email
            multiline: False

        Label:
            text: "Phone Number:"
        TextInput:
            id: phone
            multiline: False
            input_filter: 'int'

        Label:
            text: "First Name:"
        TextInput:
            id: first_name
            multiline: False

        Label:
            text: "Last Name:"
        TextInput:
            id: last_name
            multiline: False

        Label:
            text: "Birthdate (YYYY-MM-DD):"
        TextInput:
            id: birthdate
            multiline: False

        Button:
            text: "Sign Up"
            on_press: root.sign_up()

        Button:
            text: "Already have an account? Log In"
            on_press: root.manager.current = 'login'


<LoginScreen>:
    GridLayout:
        cols: 2
        padding: 20
        spacing: 10

        Label:
            text: "Phone Number:"
        TextInput:
            id: phone
            multiline: False
            input_filter: 'int'

        Label:
            text: "Birthdate (YYYY-MM-DD):"
        TextInput:
            id: birthdate
            multiline: False

        Button:
            text: "Log In"
            on_press: root.login()

        Button:
            text: "Don't have an account? Sign Up"
            on_press: root.manager.current = 'signup'


<SelectScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 40
        spacing: 20

        Label:
            text: "Choose an Option"
            font_size: '28sp'
            size_hint_y: 0.3
            halign: 'center'
            valign: 'middle'

        Button:
            text: "Become a Worker"
            size_hint_y: 0.3
            font_size: '20sp'
            background_color: (0.2, 0.6, 0.8, 1)
            on_release: root.on_worker()

        Button:
            text: "Become an Employer"
            size_hint_y: 0.3
            font_size: '20sp'
            background_color: (0.1, 0.7, 0.3, 1)
            on_release: root.on_employer()


<InterestsScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 10

        Label:
            text: "Choose Your Interest"
            font_size: 28
            size_hint: 1, 0.1

        Label:
            text: "What kind of work are you into? Or what do you need help with?"
            font_size: 18
            size_hint: 1, 0.1

        GridLayout:
            id: grid_layout
            cols: 2
            spacing: 10
            size_hint: 1, 0.7

            ToggleButton:
                text: "House Cleaning"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Laundry Folding & Ironing"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Dishwashing"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Gardening & Yardwork"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Home Organizing"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Dog Walking"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Pet Sitting"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Bathing & Grooming"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Elderly Assistance"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Babysitting"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Homework Tutoring"
                size_hint_y: None
                height: 40
            ToggleButton:
                text: "Grocery Shopping"
                size_hint_y: None
                height: 40

        Button:
            text: "Next"
            size_hint: 1, 0.1
            on_press: root.process_interests()


<JobScreen1>:
    BoxLayout:
        orientation: "vertical"

        Label:
            text: 'Available Jobs (Worker)'
            size_hint_y: 0.2

        Spinner:
            id: spinner_id
            text: "Filter"
            values: ["Location", "Salary", "Time"]
            size_hint: (None, None)
            size: dp(120), dp(40)
            pos_hint: {"center_y": 0.5}
            on_text: root.spinner_clicked(spinner_id.text)

        GridLayout:
            cols: 2
            size_hint_y: 0.7
            spacing: dp(15)
            padding: dp(20)

            MDCard:
                style: "outlined"
                orientation: "vertical"
                padding: dp(10)
                on_touch_down:
                    if self.collide_point(*args[1].pos): root.show_job_details()
                MDLabel:
                    text: "Job 1 - Click me"
                    halign: "center"
                    valign: "middle"
                    text_size: self.size

            MDCard:
                style: "outlined"
                orientation: "vertical"
                padding: dp(10)
                on_touch_down:
                    if self.collide_point(*args[1].pos): root.show_job_details()
                MDLabel:
                    text: "Job 2 - Click me"
                    halign: "center"
                    valign: "middle"
                    text_size: self.size

            MDCard:
                style: "outlined"
                orientation: "vertical"
                padding: dp(10)
                on_touch_down:
                    if self.collide_point(*args[1].pos): root.show_job_details()
                MDLabel:
                    text: "Job 3 - Click me"
                    halign: "center"
                    valign: "middle"
                    text_size: self.size

            MDCard:
                style: "outlined"
                orientation: "vertical"
                padding: dp(10)
                on_touch_down:
                    if self.collide_point(*args[1].pos): root.show_job_details()
                MDLabel:
                    text: "Job 4 - Click me"
                    halign: "center"
                    valign: "middle"
                    text_size: self.size

        MDNavigationBar:
            panel_color: "#222222"
            selected_color_background: "#4CAF50"
            text_color_active: "#FFFFFF"
            text_color_disabled: "#AAAAAA"
            size_hint_y: None
            height: dp(64)

            MDNavigationItem:
                icon: "home"
                text: "Home"
                on_release: print("Home")

            MDNavigationItem:
                icon: "magnify"
                text: "Chat"
                on_release: print("Chat")

            MDNavigationItem:
                icon: "account"
                text: "Pending"
                on_release: print("Pending")


<JobDetailsScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10

        BoxLayout:
            size_hint_y: 0.1

            Button:
                text: "<"
                on_press:
                    root.manager.current = "job_screen_1"

            Label:
                text: "Employer's Name"

        Label:
            text: "Job: House Cleaning"

        Label:
            text: "Location: Makati City"

        Label:
            text: "Date & Time: May 25, 2025 - 9:00 AM"

        Label:
            text: "Salary: â‚±1,500"

        Button:
            text: "Accept job offer"
            background_color: 1, 0, 0, 1
            size_hint_y: 0.2
            on_press:
                root.accept_job()


<JobScreen2>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        Label:
            text: "Employer's Job Listings"
            size_hint_y: 0.1
            font_size: 24

        GridLayout:
            id: job_grid
            cols: 2
            spacing: dp(10)
            size_hint_y: 0.8

        MDFabButton:
            style: "large"
            icon: "plus"
            md_bg_color: "green"
            pos_hint: {"right": 0.95, "y": 0.05}
            on_release:
                app.root.current = "editable_screen"
        
        MDNavigationBar:
            panel_color: "#222222"
            selected_color_background: "#4CAF50"
            text_color_active: "#FFFFFF"
            text_color_disabled: "#AAAAAA"
            size_hint_y: None
            height: dp(64)
            pos_hint: {"center_x": 0.5, "y": 0}

            MDNavigationItem:
                icon: "home"
                text: "Home"
                on_release: print("Home clicked")

            MDNavigationItem:
                icon: "account"
                text: "Profile"
                on_release: print("Profile clicked")


<EditableJobScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: 20
        spacing: 15

        MDTextField:
            id: edit_title
            hint_text: "Job Title"
            required: True

        MDTextField:
            id: edit_location
            hint_text: "Location"
            required: True

        MDTextField:
            id: edit_time
            hint_text: "Date & Time"
            required: True

        MDTextField:
            id: edit_salary
            hint_text: "Salary"
            required: True

        Button:
            text: "Save Job"
            size_hint_y: None
            height: dp(48)
            on_release:
                root.save_details()

        Button:
            text: "Back"
            size_hint_y: None
            height: dp(48)
            on_release:
                app.root.current = "job_screen"

