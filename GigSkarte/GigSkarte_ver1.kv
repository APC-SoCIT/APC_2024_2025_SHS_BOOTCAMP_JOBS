#:import dp kivy.metrics.dp
#:import MDCard kivymd.uix.card.MDCard
#:import MDLabel kivymd.uix.label.MDLabel
#:import MDTextField kivymd.uix.textfield.MDTextField

ScreenManager:
    SignUpScreen:
        name: "signup"
    LoginScreen:
        name: "login"
    SelectScreen:
        name: "select"
    InterestsScreen:
        name: "interests"
    JobScreen1:
        name: "job_screen_1"
    JobDetailsScreen:
        name: "job_details"
    JobScreen2:
        name: "job_screen"
    EditableJobScreen:
        name: "editable_screen"

<SignUpScreen>:
    name: "signup"
    canvas.before:
        Color:
            rgba: 0.93, 0.92, 0.89, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        padding: "40dp"
        spacing: "20dp"

        MDLabel:
            text: "[b]GigSkarte[/b]"
            markup: True
            halign: "center"
            size_hint_y: None
            height: self.texture_size[1]

        MDLabel:
            text: "Please enter your details:"
            text_color: 0, 0, 0, 1
            halign: "center"
            size_hint_y: None
            height: self.texture_size[1]

        MDTextField:
            id: first_name
            hint_text: "First Name"
            helper_text: "Required"
            helper_text_mode: "on_error"
            required: True

        MDTextField:
            id: last_name
            hint_text: "Last Name"
            text_color: 0, 0, 0, 1
            fill_color: 1, 1, 1, 1
            line_color_focus: 0, 0, 0, 1
            helper_text: "Required"
            helper_text_mode: "on_error"
            required: True

        MDTextField:
            id: password
            hint_text: "Password"
            password: True
            helper_text: "Required"
            helper_text_mode: "on_error"
            required: True

        MDTextField:
            id: phone
            hint_text: "Phone Number"
            text_color: 0, 0, 0, 1
            fill_color: 1, 1, 1, 1
            line_color_focus: 0, 0, 0, 1
            helper_text: "Required"
            helper_text_mode: "on_error"
            required: True
            input_filter: "int"

        MDTextField:
            id: email
            hint_text: "Email Address (optional)"
            text_color: 0, 0, 0, 1
            fill_color: 1, 1, 1, 1
            line_color_focus: 0, 0, 0, 1
            helper_text_mode: "on_focus"

        MDLabel:
            text: "Birthdate"
            text_color: 0, 0, 0, 1
            size_hint_y: None
            height: "20dp"

        BoxLayout:
            size_hint_y: None
            height: "40dp"
            spacing: "15dp"

            Spinner:
                id: birth_month
                text: "Month"
                values: [str(i) for i in range(1, 13)]
                size_hint_x: 0.3

            Spinner:
                id: birth_day
                text: "Day"
                values: [str(i) for i in range(1, 32)]
                size_hint_x: 0.3

            Spinner:
                id: birth_year
                text: "Year"
                values: [str(i) for i in range(1950, 2025)]
                size_hint_x: 0.4

        BoxLayout:
            size_hint_y: None
            height: "50dp"
            spacing: "20dp"
            padding: [0, 10, 0, 0]

            Button:
                text: "Sign Up"
                background_color: 0.87, 0.22, 0.27, 1 
                on_release: root.sign_up()

            Button:
                text: "Already have an account? Log in"
                font_size: "14sp"
                background_color: 0, 0, 0, 0
                color: 0.87, 0.22, 0.27, 1
                halign: "center"
                text_size: self.width, None
                size_hint_x: 1
                on_release: root.login()

<LoginScreen>:
    name: "login"
    canvas.before:
        Color:
            rgba: 0.93, 0.92, 0.89, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        padding: "40dp"
        spacing: "20dp"

        MDLabel:
            text: "[b]GigSkarte[/b]"
            markup: True
            halign: "center"

        MDLabel:
            text: "Login to your account"
            text_color: 0, 0, 0, 1
            halign: "center"

        MDTextField:
            id: phone
            text: "Phone Number"
            text_color: 0, 0, 0, 1
            mode: "filled"
            input_filter: "int"
            max_text_length: 15
            required: True

        MDTextField:
            id: password
            hint_text: "Password"
            password: True
            helper_text: "Required"
            helper_text_mode: "on_error"
            required: True

        MDLabel:
            text: "Birthdate"
            text_color: 0, 0, 0, 1
            size_hint_y: None
            height: "20dp"

        BoxLayout:
            size_hint_y: None
            height: "40dp"
            spacing: "15dp"

            Spinner:
                id: birth_month
                text: "Month"
                values: [str(i) for i in range(1, 13)]
                size_hint_x: 0.3

            Spinner:
                id: birth_day
                text: "Day"
                values: [str(i) for i in range(1, 32)]
                size_hint_x: 0.3

            Spinner:
                id: birth_year
                text: "Year"
                values: [str(i) for i in range(1950, 2025)]
                size_hint_x: 0.4

        BoxLayout:
            size_hint_y: None
            height: "50dp"
            spacing: "20dp"
            padding: [0, 10, 0, 0]

            Button:
                text: "Log In"
                background_color: 0.87, 0.22, 0.27, 1
                color: 1, 1, 1, 1
                on_release: root.login()
                
<SelectScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: "40dp", "80dp"
        spacing: "40dp"
        canvas.before:
            Color:
                rgba: 0.93, 0.92, 0.89, 1  # bg color EEEAE2 approx
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "Choose an Option"
            font_size: '28sp'
            size_hint: 1, 0.3
            halign: 'center'
            valign: 'middle'
            text_size: self.size
            color: 0.87, 0.22, 0.27, 1  # DD3846 accent color

        Button:
            text: "Become a Worker"
            size_hint: 1, 0.3
            font_size: '20sp'
            background_normal: ''
            background_color: 0.87, 0.22, 0.27, 1  # DD3846
            color: 1, 1, 1, 1
            on_release: root.on_worker()

        Button:
            text: "Become an Employer"
            size_hint: 1, 0.3
            font_size: '20sp'
            background_normal: ''
            background_color: 0.87, 0.22, 0.27, 1  # DD3846
            color: 1, 1, 1, 1
            on_release: root.on_employer()
            

<InterestToggle@ToggleButton>:
    background_normal: ''
    background_down: ''
    size_hint_y: None
    height: dp(60)
    background_color: (0.9, 0.9, 0.9, 1) if self.state == 'normal' else (0.87, 0.22, 0.27, 1)
    color: (0, 0, 0, 1) if self.state == 'normal' else (1, 1, 1, 1)
    canvas.before:
        Color:
            rgba: self.background_color
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [15]

<InterestsScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: dp(20)
        spacing: dp(10)
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            RoundedRectangle:
                size: self.size
                pos: self.pos
                radius: [20,]

        Label:
            text: "Choose Your Interest"
            font_size: '28sp'
            size_hint_y: 0.1
            color: 0, 0, 0, 1

        Label:
            text: "What kind of work are you into? Or what do you need help with?"
            font_size: '16sp'         
            size_hint_y: None        
            height: self.texture_size[1]  
            text_size: self.width - dp(40), None   
            halign: 'center'         
            valign: 'middle'         
            color: 0, 0, 0, 1

        ScrollView:
            size_hint_y: 0.7
            do_scroll_x: False

            GridLayout:
                id: grid_layout
                cols: 2
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

                ColorChangingToggleButton:
                    text: "House Cleaning"
                ColorChangingToggleButton:
                    text: "Laundry Folding & Ironing"
                ColorChangingToggleButton:
                    text: "Dishwashing"
                ColorChangingToggleButton:
                    text: "Gardening & Yardwork"
                ColorChangingToggleButton:
                    text: "Home Organizing"
                ColorChangingToggleButton:
                    text: "Dog Walking"
                ColorChangingToggleButton:
                    text: "Pet Sitting"
                ColorChangingToggleButton:
                    text: "Bathing & Grooming"
                ColorChangingToggleButton:
                    text: "Elderly Assistance"
                ColorChangingToggleButton:
                    text: "Babysitting"
                ColorChangingToggleButton:
                    text: "Homework Tutoring"
                ColorChangingToggleButton:
                    text: "Grocery Shopping"
                ColorChangingToggleButton:
                    text: "Watering Plants"
                ColorChangingToggleButton:
                    text: "Washing Clothes"
                ColorChangingToggleButton:
                    text: "Taking out the Trash"
                ColorChangingToggleButton:
                    text: "Decluttering Shelves"
                ColorChangingToggleButton:
                    text: "Cleaning the Toilet"
                ColorChangingToggleButton:
                    text: "Wiping Windows"

        Button:
            text: "Next"
            size_hint_y: 0.1
            background_normal: ''
            background_color: 0.87, 0.22, 0.27, 1
            color: 1, 1, 1, 1
            on_press: root.process_interests()

<ColorChangingToggleButton@ToggleButton>:
    background_normal: ''
    background_down: ''
    background_color: (0.83, 0.83, 0.83, 1) if self.state == 'normal' else (0.87, 0.22, 0.27, 1)
    color: (0, 0, 0, 1) if self.state == 'normal' else (1, 1, 1, 1)
    size_hint_y: None
    height: self.texture_size[1] + dp(20) 
    text_size: self.width - dp(20), None   
    halign: 'center'
    valign: 'middle'
    padding: dp(10), dp(10)
    shorten: False                        
    canvas.before:
        Color:
            rgba: self.background_color
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [20]

<JobScreen1>:
    BoxLayout:
        orientation: 'vertical'
        md_bg_color: "#EEEAE2"

        MDTopAppBar:
            type: "small"

            MDTopAppBarLeadingButtonContainer:

                MDActionTopAppBarButton:
                    icon: "menu"

            MDTopAppBarTitle:
                text: "GigSkarte"
                halign: "center"

        MDLabel:
            text: "Available Jobs"
            halign: "center"
            size_hint_y: None
            height: dp(40)

        Spinner:
            id: spinner_id
            text: "Filter"
            values: ["Location", "Salary", "Time"]
            size_hint: (None, None)
            size: dp(120), dp(40)
            pos_hint: {"center_x": 0.5}
            on_text: root.spinner_clicked(spinner_id.text)

        ScrollView:
            GridLayout:
                id: job_grid_1
                cols: 2
                spacing: dp(10)
                padding: dp(10)
                on_touch_down:
                    if self.collide_point(*args[1].pos): root.show_job_details()
                MDLabel:
                    text: "Job 4 - Click me"
                    halign: "center"
                    valign: "middle"
                    text_size: self.size

        MDNavigationBar:
            panel_color: "#222222"
            selected_color_background: "#DD3846"
            text_color_active: "#000000"
            text_color_disabled: "#EEEAE2"
            size_hint_y: None
            height: dp(50)
            padding: 10

        
        Spinner:
            id: spinner_id
            text: "Select Job"
            values: ["Cleaning", "Moving", "Laundry", "Pet Sitting", "Errands", "Babysitting"]
            on_text: root.spinner_clicked(self.text)

        Button:
            text: "View Job Details"
            size_hint_y: None
            height: dp(50)
            on_release: root.show_job_details()

<JobDetailsScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        md_bg_color: "#EEEAE2"

        MDBoxLayout:
            size_hint_y: 0.1

            MDButton:
                text: "<"
                md_bg_color: "#DD3846"
                text_color: "white"
                on_release:
                    root.manager.current = "job_screen_1"

            MDLabel:
                text: "Employer's Name"
                theme_text_color: "Custom"
                text_color: "#DD3846"

        MDLabel:
            id: job_title
            text: "Job: "
            theme_text_color: "Custom"
            text_color: "#DD3846"

        MDLabel:
            id: job_location
            text: "Location: "
            theme_text_color: "Custom"
            text_color: "#DD3846"

        MDLabel:
            id: job_time
            text: "Date & Time: "
            theme_text_color: "Custom"
            text_color: "#DD3846"

        MDLabel:
            id: job_salary
            text: "Salary: "
            theme_text_color: "Custom"
            text_color: "#DD3846"

        MDButton:
            text: "Accept job offer"
            md_bg_color: "#DD3846"
            text_color: "white"
            size_hint_y: 0.2
            on_release:
                root.accept_job()

<JobScreen2>:
    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: "#EEEAE2"

        MDTopAppBar:
            type: "small"

            MDTopAppBarLeadingButtonContainer:

                MDActionTopAppBarButton:
                    icon: "menu"

            MDTopAppBarTitle:
                text: "GigSkarte"
                halign: "center"

        MDLabel:
            text: "Your Job Listings"
            size_hint_y: 0.1
            font_size: 24
            halign: "center"
            theme_text_color: "Custom"
            text_color: "#000000"

        GridLayout:
            id: job_grid
            cols: 2
            spacing: dp(10)
            padding: dp(15)
            size_hint_y: 0.8

        MDFabButton:
            style: "large"
            icon: "plus"
            theme_icon_color: "Custom"
            icon_color: "#EEEAE2"
            theme_bg_color: "Custom"
            md_bg_color: "#DD3846"
            pos_hint: {"right": 0.95, "y": 0.05}
            on_release:
                app.root.current = "editable_screen"
        
        MDNavigationBar:
            text_color_active: "#FFFFFF"
            text_color_disabled: "#AAAAAA"
            size_hint_y: None
            height: dp(64)
            pos_hint: {"center_x": 0.5, "y": 0}

            MDNavigationItem:
                icon: "home"
                text: "Home"
                on_release: print("Home clicked")

            MDNavigationItem:
                icon: "account"
                text: "Profile"
                on_release: print("Profile clicked")

            MDNavigationItem:
                icon: "clock"
                text: "Pending"
                on_release: print("Pending clicked")


<EditableJobScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: 20
        spacing: 15
        md_bg_color: "#EEEAE2"

        Label:
            text: "Job Title:"
        MDTextField:
            id: edit_title
            hint_text: "Job Title"
            required: True
            helper_text: "Enter the job position/title"
            helper_text_mode: "on_focus"
            line_color_focus: "#000000"

        MDTextField:
            id: edit_location
            hint_text: "Location"
            required: True
            helper_text: "Enter the job location"
            helper_text_mode: "on_focus"
            line_color_focus: "#000000"

        MDTextField:
            id: edit_time
            hint_text: "Date & Time"
            required: True
            helper_text: "e.g. Monday 9am–5pm"
            helper_text_mode: "on_focus"
            line_color_focus: "#000000"

        MDTextField:
            id: edit_salary
            hint_text: "Salary"
            required: True
            helper_text: "Enter the compensation (e.g. ₱500/day)"
            helper_text_mode: "on_focus"
            line_color_focus: "#000000"

        MDButton:
            style: "filled"
            theme_bg_color: "Custom"
            md_bg_color: "#DD3846"
            pos_hint: {"center_x": 0.5}
            size_hint_y: None
            height: dp(48)
            on_release:
                root.save_details()
            MDButtonText:
                text: "Save Job"
                theme_text_color: "Custom"
                text_color: "#EEEAE2"


        MDButton:
            style: "outlined"
            pos_hint: {"center_x": 0.5}
            size_hint_y: None
            height: dp(48)
            on_release:

                app.root.current = "job_screen"
            MDButtonText:
                text: "Back"


